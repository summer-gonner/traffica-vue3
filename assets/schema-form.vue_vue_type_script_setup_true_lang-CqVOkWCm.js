import{ds as De,dt as Ee,du as We,aN as Le,b as S,F as t,ab as we,dv as Ke,dw as Ne,cJ as B,d as le,a8 as xe,c as D,cG as qe,dx as $,c9 as te,K as re,cO as Ge,aT as ge,G as fe,Y as G,w as me,cs as Ue,v as ze,x as He,n as T,B as V,E as z,dd as Z,V as ne,q as be,a5 as H,y as ve,H as ce,L as U,dy as Ye,ak as je,aX as Je,Q as Se,a3 as Xe,k as _e,dz as Ze,A as Qe,W as et,cZ as tt,r as Be,az as ye,dA as J,bg as nt,de as ke,dB as st,cN as ot,dC as at}from"./index-B8Pm80oX.js";import{i as Ae}from"./isNumber-BQFvOqOr.js";import{c as rt,s as ct,d as lt,e as it,f as ut}from"./ApiSelect.vue_vue_type_script_setup_true_lang-CofY2-NC.js";import{d as Fe}from"./dayjs.min-TeQhONF1.js";import{i as X}from"./is-BPG7p_4t.js";import{c as dt}from"./cloneDeep-lQkziu_-.js";import{b as ft,C as mt,A as pt,F as Pe}from"./index-BT78Vb1q.js";import{d as ht}from"./debounce-TsE9rPWj.js";import{D as gt}from"./index-7VmM7i5b.js";import{D as yt}from"./DownOutlined-BRycSuUV.js";import{d as Ce}from"./index-CIQauGJF.js";import{d as Ie}from"./dateUtil-E1W9AnjJ.js";import{b as bt}from"./_baseUniq-kMXtQ-ld.js";import{p as vt}from"./pick-yPjmipd3.js";var St="[object Boolean]";function ae(a){return a===!0||a===!1||De(a)&&Ee(a)==St}function Te(a){return a==null}function wt(a){return a===null}function At(a){return a===void 0}function Pt(a,g){return a&&a.length?bt(a,ft(g)):[]}function Me(a,g){return a==null?!0:We(a,g)}const $e=Le(mt),Rt=Le(pt);function xt(a,g){return S(()=>{const u=t(a),{labelCol:v={},wrapperCol:y={}}=u.formItemProps||{},{labelWidth:i,disabledLabelWidth:F}=u,{labelWidth:h,labelCol:w,wrapperCol:O,layout:M}=t(g);if(!h&&!i&&!w||F)return v.style={textAlign:"left"},{labelCol:v,wrapperCol:y};let l=i||h;const R={...w,...v},k={...O,...y};return l&&(l=Ae(l)?`${l}px`:l),{labelCol:{style:{width:l},...R},wrapperCol:{style:{width:M==="vertical"?"100%":`calc(100% - ${l})`},...k}}})}function Oe(a,g=""){const{t:u}=we();if(a.includes("Input")||a.includes("Complete"))return`${u("common.inputText")}${g}`;const v=["Select","Cascader","Checkbox","CheckboxGroup","Switch","TreeSelect"];return a.includes("Picker")||v.includes(a)?`${u("common.chooseText")}${g}`:""}const Bt=["DatePicker","MonthPicker","WeekPicker","TimePicker"];function kt(){return[...Bt,"RangePicker"]}function Ft(a,g){return a&&["Input","InputPassword","InputSearch","InputTextArea"].includes(a)&&g&&Ae(g)?`${g}`:g}const Ct=kt(),Ve=Symbol("schema-form");async function It(a){Ke(Ve,a)}function Re(a={}){return Ne(Ve,a)}const Tt={formModel:{type:Object,default:()=>({})},schema:{type:Object,default:()=>({})},tableInstance:{type:Object},tableRowKey:{type:[String,Number]}};function Mt(a,g="default",u){if(!a||!Reflect.has(a,g))return null;if(!B(a[g]))return console.error(`${g} is not a function!`),null;const v=a[g];return v?v(u):null}const Ot={maxWidth:{type:String,default:"600px"},showIndex:{type:Boolean},color:{type:String,default:"#ffffff"},fontSize:{type:String,default:"14px"},placement:{type:String,default:"right"},text:{type:[Array,String]}},Lt=le({name:"BasicHelp",components:{Tooltip:xe},props:Ot,setup(a,{slots:g}){const u=S(()=>({color:a.color,fontSize:a.fontSize})),v=S(()=>({maxWidth:a.maxWidth}));function y(){const i=a.text;return $(i)?D("p",null,[i]):te(i)?i.map((F,h)=>D("p",{key:F},[D(re,null,[a.showIndex?`${h+1}. `:"",F])])):null}return()=>D(xe,{overlayClassName:"basic-help__wrap",title:D("div",{style:t(u)},[y()]),autoAdjustOverflow:!0,overlayStyle:t(v),placement:a.placement},{default:()=>[D("span",{class:"basic-help"},[Mt(g)||D(qe,null,null)])]})}}),jt={class:"mr-[6px]"},_t={class:"ml-[6px]"},$t=le({name:"SchemaFormItem",__name:"schema-form-item",props:Tt,emits:["update:formModel"],setup(a,{emit:g}){const u=a,v=g,y=Re(),{formPropsRef:i,setItemRef:F,updateSchema:h,getSchemaByField:w,appendSchemaByField:O}=y,{t:M}=we(),{schema:l}=Ge(u),R=xt(l,i),k=S(()=>te(l.value.field)?l.value.field:l.value.field.split(".")),A=S({get(){return k.value.reduce((s,o)=>s==null?void 0:s[o],u.formModel)},set(s){const o=l.value.field.split("."),d=o.pop(),e=o.reduce((n,r)=>n[r]??(n[r]={}),u.formModel);e[d]=s,v("update:formModel",u.formModel)}}),E=S(()=>{const{component:s,componentProps:o}=l.value;if(!B(o)&&(o!=null&&o.vModelKey))return o.vModelKey;const d=$(s)&&["Switch","Checkbox"].includes(s),e=s==="Upload";return{true:"value",[`${d}`]:"checked",[`${e}`]:"file-list"}.true}),m=S(()=>{const{formModel:s,schema:o,tableInstance:d}=u,{mergeDynamicData:e}=t(i);return{field:o.field,formInstance:y,tableInstance:d,tableRowKey:u.tableRowKey,formModel:u.tableRowKey?s[u.tableRowKey]:s,values:{...e,...s},schema:S(()=>u.schema)}}),b=S(()=>{const{vShow:s,vIf:o,isAdvanced:d=!1}=t(l),{showAdvancedButton:e}=t(i),n=e&&ae(d)?d:!0;let r=!0,p=!0;return ae(s)&&(r=s),ae(o)&&(p=o),B(s)&&(r=s(t(m))),B(o)&&(p=o(t(m))),r=r&&n,{isShow:r,isIfShow:p}}),N=S(()=>{const{disabled:s}=t(i),{dynamicDisabled:o}=u.schema,{disabled:d=!1}=t(L);let e=!!s||d;return ae(o)&&(e=o),B(o)&&(e=o(t(m))),e}),P=(s,o=t(m))=>{if($(s))return D(re,null,[s]);if(ge(s))return s;if(B(s))return P(s(o));if(s&&X(s)){const d=Object.keys(s);return d.some(e=>e.startsWith("_")||["setup","render"].includes(e))?s:d.reduce((e,n)=>(e[n]=(...r)=>P(s[n],...r),e),{})}return s},C=S(()=>{const s=u.schema.component;return $(s)?rt[s]??P(s):P(s)}),Y=S(()=>{const s=u.schema.componentSlots??{};return $(s)||ge(s)?{default:(...o)=>P(s,o)}:P(s)}),W=S(()=>{const s=u.schema.label;return B(s)?s(t(m)):s}),L=S(()=>{const{schema:s}=u;let{componentProps:o={},component:d}=s;return B(o)&&(o=o(t(m))??{}),d!=="RangePicker"&&$(d)&&(o.placeholder??(o.placeholder=Oe(d,W.value))),s.component==="Divider"&&(o=Object.assign({type:"horizontal"},o,{orientation:"left",plain:!0})),ge(C.value)&&Object.assign(o,C.value.props),o}),Q=S(()=>{const s=L.value;return Object.keys(s).reduce((o,d)=>{if(/^on([A-Z])/.test(d)){const e=d.replace(/^on([A-Z])/,"$1").toLocaleLowerCase();o[e]=s[d]}return o},{})}),ie=S(()=>{const{helpMessage:s,helpComponentProps:o,subLabel:d}=u.schema,e=d?D("span",null,[W.value,fe(" "),D("span",{class:"text-secondary"},[d])]):P(W.value),n=B(s)?s(t(m)):s;return!n||Array.isArray(n)&&n.length===0?e:D("span",null,[e,D(Lt,G({placement:"top",class:"mx-1",text:n},o),null)])});function pe(s,o,d){["DatePicker","MonthPicker","WeekPicker","TimePicker"].includes(o)?s.type=d?"string":"object":["RangePicker","Upload","CheckboxGroup","TimePicker"].includes(o)?s.type="array":["InputNumber"].includes(o)&&(s.type="number")}const he=S(()=>{var oe;const{rules:s=[],component:o,rulesMessageJoinLabel:d,dynamicRules:e,required:n}=u.schema;if(B(e))return e(t(m));let r=dt(s);const{rulesMessageJoinLabel:p}=t(i),f=Reflect.has(t(i),"rulesMessageJoinLabel")?d:p,c=$(o)?`${Oe(o,W.value)}${f?W.value:""}`:void 0;function x(q,K){const de=q.message||c;return K===void 0||wt(K)||Array.isArray(K)&&K.length===0||typeof K=="string"&&K.trim()===""||typeof K=="object"&&Reflect.has(K,"checked")&&Reflect.has(K,"halfChecked")&&Array.isArray(K.checked)&&Array.isArray(K.halfChecked)&&K.checked.length===0&&K.halfChecked.length===0?Promise.reject(de):Promise.resolve()}const I=B(n)?n(t(m)):n;(!r||r.length===0)&&I&&(r=[{required:I,validator:x}]);const j=r.findIndex(q=>Reflect.has(q,"required")&&!Reflect.has(q,"validator"));if(j!==-1){const q=r[j];if(o&&$(o)){Reflect.has(q,"type")||(q.type=o==="InputNumber"?"number":"string"),q.message=q.message||c,(o.includes("Input")||o.includes("Textarea"))&&(q.whitespace=!0);const K=(oe=t(L))==null?void 0:oe.valueFormat;pe(q,o,K)}}const _=r.findIndex(q=>q.max);return _!==-1&&!r[_].validator&&(r[_].message=r[_].message||M("component.form.maxTip",[r[_].max])),r}),ue=async s=>{try{const o=Object.assign(l.value,{loading:!0,componentProps:{...t(L),options:[]}});h(o);const d=await s(t(m)),{component:e}=t(l),n=o.componentProps;["Select","RadioGroup","CheckboxGroup"].some(r=>r===e)?n.options=d:["TreeSelect","Tree"].some(r=>r===e)&&(n.treeData=d),o.componentProps&&(o.componentProps.requestResult=d),o.loading=!1,h(o)}finally{await Xe(),l.value.loading=!1}},se=()=>{const s=L.value.request;if(s)if(B(s))ue(s);else{const{watchFields:o=[],options:d={},wait:e=0,callback:n}=s,r=o.map(p=>()=>u.formModel[p]);me(r,ht(()=>{ue(n)},e),{...d})}};return me(b,(s,o)=>{!Ue(s,o)&&s.isIfShow&&s.isShow&&(w(u.schema.field)||O(u.schema),se())},{immediate:!0}),(s,o)=>b.value.isIfShow?ze((T(),V(t($e),Z(G({key:0},t(l).colProps)),{default:z(()=>[t(l).component==="Divider"?(T(),V(t(gt),Z(G({key:0},Object.assign(L.value))),{default:z(()=>[(T(),V(ne(ie.value)))]),_:1},16)):(T(),V(t(Pe).Item,G({key:1},{...t(l).formItemProps,...t(R)},{label:ie.value,name:k.value,rules:he.value}),{default:z(()=>[t(l).beforeSlot?(T(),be(re,{key:0},[t($)(t(l).beforeSlot)?H(s.$slots,t(l).beforeSlot,Z(G({key:0},m.value)),()=>[ve("span",jt,ce(t(l).beforeSlot),1)],!0):U("",!0),t(B)(t(l).beforeSlot)?(T(),V(ne(t(l).beforeSlot(m.value)),{key:1})):U("",!0)],64)):U("",!0),t(l).slot?H(s.$slots,t(l).slot,Z(G({key:1},m.value)),void 0,!0):C.value?(T(),V(ne(C.value),G({key:2,ref:t(F)(t(l).field)},L.value,{[E.value]:A.value,["onUpdate:"+E.value]:o[0]||(o[0]=d=>A.value=d),"allow-clear":!0,disabled:N.value,loading:t(l).loading},Ye(Q.value)),je({_:2},[Object.is(t(l).loading,!0)?{name:"notFoundContent",fn:z(()=>[D(t(Je),{size:"small"})]),key:"0"}:void 0,Se(Y.value,(d,e)=>({name:e,fn:z(n=>[(T(),V(ne((d==null?void 0:d({...m.value,slotData:n}))??d),{key:e}))])}))]),1040,["disabled","loading"])):U("",!0),t(l).afterSlot?(T(),be(re,{key:3},[t($)(t(l).afterSlot)?H(s.$slots,t(l).afterSlot,Z(G({key:0},m.value)),()=>[ve("span",_t,ce(t(l).afterSlot),1)],!0):U("",!0),t(B)(t(l).afterSlot)?(T(),V(ne(t(l).afterSlot(m.value)),{key:1})):U("",!0)],64)):U("",!0)]),_:3},16,["label","name","rules"]))]),_:3},16)),[[He,b.value.isShow]]):U("",!0)}}),Vt=_e($t,[["__scopeId","data-v-6eb69da8"]]),Dt=le({__name:"index",props:{expand:{type:Boolean}},setup(a){Ze(v=>({"14707f9d":u.value}));const g=a,u=S(()=>`${g.expand?0:.5}turn`);return(v,y)=>(T(),V(t(yt),{class:"collapse-icon"}))}}),Et=_e(Dt,[["__scopeId","data-v-510618ab"]]),Wt=le({name:"FormAction",inheritAttrs:!1,__name:"form-action",props:{showActionButtonGroup:{type:Boolean,default:!0},showResetButton:{type:Boolean,default:!0},showSubmitButton:{type:Boolean,default:!0},showAdvancedButton:{type:Boolean,default:!0},resetButtonOptions:{type:Object,default:()=>({})},submitButtonOptions:{type:Object,default:()=>({})},actionColOptions:{type:Object,default:()=>({})},actionSpan:{type:Number,default:6},isAdvanced:Boolean,hideAdvanceBtn:Boolean},emits:["toggle-advanced"],setup(a,{emit:g}){const u=g,v=a,{t:y}=we(),{resetFields:i,submit:F}=Re(),h=S(()=>{const{showAdvancedButton:R,actionSpan:k,actionColOptions:A}=v,E=24-k,m=R?{span:E<6?24:E}:{};return{style:{textAlign:"right"},span:R?6:4,...m,...A}}),w=S(()=>Object.assign({text:y("common.resetText")},v.resetButtonOptions)),O=S(()=>Object.assign({text:y("common.queryText")},v.submitButtonOptions));function M(){u("toggle-advanced",v.isAdvanced)}const l=async R=>{await F(R).catch(()=>{})};return(R,k)=>{const A=Qe("a-button");return a.showActionButtonGroup?(T(),V(t($e),Z(G({key:0},h.value)),{default:z(()=>[ve("div",{style:et([{width:"100%"},{textAlign:h.value.style.textAlign}])},[D(t(Pe).Item,null,{default:z(()=>[H(R.$slots,"resetBefore"),a.showResetButton?(T(),V(A,G({key:0,type:"default",class:"mr-2"},w.value,{onClick:t(i)}),{default:z(()=>[fe(ce(w.value.text),1)]),_:1},16,["onClick"])):U("",!0),H(R.$slots,"submitBefore"),a.showSubmitButton?(T(),V(A,G({key:1,type:"primary",class:"mr-2"},O.value,{onClick:k[0]||(k[0]=E=>l(E))}),{default:z(()=>[fe(ce(O.value.text),1)]),_:1},16)):U("",!0),H(R.$slots,"advanceBefore"),a.showAdvancedButton&&!a.hideAdvanceBtn?(T(),V(A,{key:2,type:"link",size:"small",onClick:M},{default:z(()=>[fe(ce(a.isAdvanced?t(y)("component.form.putAway"):t(y)("component.form.unfold"))+" ",1),D(t(Et),{class:"ml-1",expand:!a.isAdvanced},null,8,["expand"])]),_:1})):U("",!0),H(R.$slots,"advanceAfter")]),_:3})],4)]),_:3},16)):U("",!0)}}}),Kt=a=>{const g=tt(),u=Be({...a}),v=ye({...a.initialValues}),y=ye({...a.initialValues}),i=Be(),F={...a.initialValues},h=new Map,w=new Map,O=ye({isAdvanced:!0,hideAdvanceBtn:!1,isLoad:!1,actionSpan:6}),M=S(()=>({...g,...u.value})),l=S(()=>{const{baseRowStyle:k={},rowProps:A}=t(M);return{style:k,...A}}),R=S(()=>({...M.value,...O}));return me(()=>u.value.schemas,()=>{var k;(k=u.value.schemas)==null||k.forEach(A=>{!w.has(A.field)&&B(A.componentProps)&&w.set(A.field,A.componentProps),At(A.defaultValue)||J(y,A.field,A.defaultValue)})}),{formModel:v,defaultFormValues:y,schemaFormRef:i,formPropsRef:u,cacheFormModel:F,compRefMap:h,getFormProps:M,advanceState:O,getRowConfig:l,getFormActionBindProps:R,originComponentPropsFnMap:w}},Nt=a=>{const{formState:g,emit:u}=a,{compRefMap:v,formModel:y,formPropsRef:i,cacheFormModel:F,schemaFormRef:h,getFormProps:w,defaultFormValues:O,originComponentPropsFnMap:M}=g,l=e=>n=>{n&&v.set(e,n)};function R(){return t(h)?se(nt(t(y))):{}}function k(e){var n;return(n=t(i).schemas)==null?void 0:n.some(r=>r.field===e&&$(r.component)?Ct.includes(r.component):!1)}async function A(e){const n=t(i).schemas,r=n.map(f=>f.field).filter(Boolean);Object.assign(F,e);const p=[];Object.entries(e).forEach(([f,c])=>{const x=n.find(j=>j.field===f),I=Reflect.has(e,f);if($(x==null?void 0:x.component)&&(c=Ft(x==null?void 0:x.component,c)),I&&r.includes(f)){if(k(f))if(Array.isArray(c)){const j=[];for(const _ of c)j.push(_?Fe(_):null);J(y,f,j)}else{const{componentProps:j}=x||{};let _=j;B(j)&&(_=_({formPropsRef:i,formModel:y})),J(y,f,c?_!=null&&_.valueFormat?c:Fe(c):null)}else J(y,f,c);p.push(f)}}),await W(p).catch(f=>{})}async function E(e){let n=[];X(e)&&n.push(e),te(e)&&(n=[...e]),t(i).schemas=n}async function m(e,n,r=!1){const p=[...t(i).schemas],f=p.findIndex(c=>c.field===n);if(!n||f===-1||r){r?p.unshift(e):p.push(e),i.value.schemas=p;return}f!==-1&&p.splice(f+1,0,e),i.value.schemas=p,C(i.value.schemas)}async function b(e){const n=[...t(i).schemas];if(!e)return;let r=$(e)?[e]:e;$(e)&&(r=[e]);for(const p of r)if($(p)){const f=n.findIndex(c=>c.field===p);f!==-1&&(Me(y,p),n.splice(f,1))}i.value.schemas=n}function N(e){return t(i).schemas.find(n=>e===n.field)}const P=e=>{let n=[];if(X(e)&&n.push(e),te(e)&&(n=[...e]),!n.every(c=>c.component==="Divider"||Reflect.has(c,"field")&&c.field)){console.error("All children of the form Schema array that need to be updated must contain the `field` field");return}const p=[],f=[];t(i).schemas.forEach(c=>{const x=n.find(I=>c.field===I.field);if(x){const I=x.componentProps,j=Ce(c,x);if(M.has(c.field)){const _=M.get(c.field);j.componentProps=oe=>({..._(oe),...B(I)?I(oe):I})}f.push(j),p.push(j)}else p.push(c)}),C(f),i.value.schemas=Pt(p,"field")};function C(e){let n=[];X(e)&&n.push(e),te(e)&&(n=[...e]);const r={},p=R();n.forEach(f=>{f.component!="Divider"&&Reflect.has(f,"field")&&f.field&&!Te(f.defaultValue)&&(!(f.field in p)||Te(p[f.field]))&&(r[f.field]=f.defaultValue)}),A(r)}async function Y(){const{resetFunc:e,submitOnReset:n}=t(w);B(e)&&await e(),Object.keys(y).forEach(r=>{J(y,r,O[r])}),u("reset",y),n&&d(),setTimeout(Q)}async function W(e){var n;return(n=h.value)==null?void 0:n.validateFields(e)}async function L(e){return await h.value.validate(e)}async function Q(e){var n;await((n=h.value)==null?void 0:n.clearValidate(e))}async function ie(e,n){var r;await((r=h.value)==null?void 0:r.scrollToField(e,n))}const pe=(e,n)=>{var p;J(y,e,n),J(F,e,n);const{validateTrigger:r}=t(w);(!r||r==="change")&&((p=h.value)==null||p.validateFields([e]))},he=e=>Me(y,e),ue=e=>{const{schemas:n}=i.value;i.value=Ce(t(i)||{},e),i.value.schemas=n!=null&&n.length?n:e.schemas};function se(e){var r,p;if(!X(e))return{};const n={};for(let[f,c]of Object.entries(e)){if(!f||te(c)&&c.length===0||B(c))continue;const{transformDateFunc:x}=t(w);X(c)&&(c=x==null?void 0:x(c)),te(c)&&((r=c[0])!=null&&r.format)&&((p=c[1])!=null&&p.format)&&(c=c.map(j=>x==null?void 0:x(j))),$(c)&&(c=c.trim());const I=N(f);if(B(I==null?void 0:I.transform)&&(c=I==null?void 0:I.transform(c),X(c))){Object.assign(n,c),Reflect.deleteProperty(n,f);continue}J(n,f,c)}return s(n)}function s(e){const n=t(w).fieldMapToTime;if(!n||!Array.isArray(n))return e;for(const[r,[p,f],c="YYYY-MM-DD"]of n){if(!r||!p||!f||!e[r])continue;const[x,I]=e[r];e[p]=Ie(x).format(c),e[f]=Ie(I).format(c),Reflect.deleteProperty(e,r)}return e}const o=e=>{const{autoSubmitOnEnter:n}=t(i);if(n&&e.key==="Enter"&&e.target&&e.target instanceof HTMLElement){const r=e.target;r&&r.tagName&&r.tagName.toUpperCase()=="INPUT"&&d(e)}};async function d(e){var p;(p=e==null?void 0:e.preventDefault)==null||p.call(e);const{submitFunc:n}=t(w);if(n&&B(n)){await n();return}if(t(h))try{const f=await L(),c=se(f);return u("submit",c),c}catch(f){return Promise.reject(f)}}return{submit:d,setItemRef:l,clearValidate:Q,validate:L,validateFields:W,getFieldsValue:R,updateSchema:P,resetSchema:E,getSchemaByField:N,appendSchemaByField:m,removeSchemaByField:b,resetFields:Y,setFieldsValue:A,scrollToField:ie,setDefaultValue:C,setFormModel:pe,delFormModel:he,setSchemaFormProps:ue,handleFormValues:se,handleEnterPress:o}};let qt,Gt,Ut;function zt(){return{screenRef:S(()=>t(qt)),widthRef:Gt,screenEnum:ct,realWidthRef:Ut}}const ee=24,Ht=a=>{const{formState:g,emit:u}=a,v=Re(),{realWidthRef:y,screenEnum:i,screenRef:F}=zt(),{advanceState:h,getFormProps:w,formPropsRef:O,formModel:M,defaultFormValues:l}=g,R=S(()=>{if(!h.isAdvanced)return 0;const m=t(w).emptySpan||0;if(Ae(m))return m;if(X(m)){const{span:b=0}=m,N=t(F);return m[N.toLowerCase()]||b||0}return 0});me([()=>O.value.schemas,()=>h.isAdvanced,()=>t(y)],()=>{const{showAdvancedButton:m}=t(w);m&&A()},{immediate:!0});function k(m,b=0,N=!1){const P=t(y),C=parseInt(m.md)||parseInt(m.xs)||parseInt(m.sm)||m.span||ee,Y=parseInt(m.lg)||C,W=parseInt(m.xl)||Y,L=parseInt(m.xxl)||W;return P<=i.LG?b+=C:P<i.XL?b+=Y:P<i.XXL?b+=W:b+=L,N?(h.hideAdvanceBtn=!1,b<=ee*2?(h.hideAdvanceBtn=!0,h.isAdvanced=!0):b>ee*2&&b<=ee*(t(w).autoAdvancedLine||3)?h.hideAdvanceBtn=!1:h.isLoad||(h.isLoad=!0,h.isAdvanced=!h.isAdvanced),{isAdvanced:h.isAdvanced,itemColSum:b}):b>ee*(t(w).alwaysShowLines||1)?{isAdvanced:h.isAdvanced,itemColSum:b}:{isAdvanced:!0,itemColSum:b}}function A(){let m=0,b=0;const{baseColProps:N={}}=t(w);for(const P of t(O).schemas){const{vShow:C,colProps:Y}=P;let W=!0;if(ae(C)&&(W=C),B(C)&&(W=C({schema:S(()=>t(formSchemasRef).schemas.find(L=>L.field===P.field)),formModel:M,field:P.field,formInstance:v,values:{...t(l),...M}})),W&&(Y||N)){const{itemColSum:L,isAdvanced:Q}=k({...N,...Y},m);m=L||0,Q&&(b=m),P.isAdvanced=Q}}h.actionSpan=b%ee+t(R),k(t(w).actionColOptions||{span:ee},m,!0),u("advanced-change")}function E(){h.isAdvanced=!h.isAdvanced}return{handleToggleAdvanced:E}},un=le({name:"SchemaForm",__name:"schema-form",props:lt,emits:it,setup(a,{expose:g,emit:u}){const v=a,y=u,i=Kt(v),{formModel:F,getRowConfig:h,schemaFormRef:w,getFormProps:O,getFormActionBindProps:M,formPropsRef:l}=i,R=Nt({formState:i,emit:y}),{handleEnterPress:k,setDefaultValue:A}=R,E={props:v,emit:y,...i,...R};It(E);const{handleToggleAdvanced:m}=Ht({formState:i,emit:y});return y("register",E),g(E),A(l.value.schemas),(b,N)=>(T(),V(t(Pe),G({ref_key:"schemaFormRef",ref:w},t(vt)(t(O),t(ut)),{model:t(F),onKeypress:at(t(k),["enter"])}),{default:z(()=>[D(t(Rt),Z(ke(t(h))),{default:z(()=>[H(b.$slots,"formHeader"),H(b.$slots,"default",{},()=>[(T(!0),be(re,null,Se(t(l).schemas,P=>(T(),V(ne(st(Vt,{},b.$slots)),{key:P.field,"form-model":t(F),"onUpdate:formModel":N[0]||(N[0]=C=>ot(F)?F.value=C:null),schema:P,"table-instance":b.tableInstance},null,40,["form-model","schema","table-instance"]))),128)),b.showActionButtonGroup?(T(),V(Wt,G({key:0},t(M),{onToggleAdvanced:t(m)}),je({_:2},[Se(["resetBefore","submitBefore","advanceBefore","advanceAfter"],P=>({name:P,fn:z(C=>[H(b.$slots,P,Z(ke(C||{})))])}))]),1040,["onToggleAdvanced"])):U("",!0)]),H(b.$slots,"formFooter")]),_:3},16)]),_:3},16,["model","onKeypress"]))}});export{Vt as S,un as _,Te as a,Lt as b,$e as c,Rt as d,ae as i,Tt as s};
