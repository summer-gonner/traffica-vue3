import{f as g}from"./dateUtil-E1W9AnjJ.js";import{T as v}from"./index-Qnpm0yEw.js";import{c as s,G as w,d as b,r as p,en as C,w as T,o as S,f as O,n as U,B,E as N,F as R,aY as f}from"./index-B8Pm80oX.js";import{u as A}from"./dynamic-table-D22kRkZE.js";import"./ApiSelect.vue_vue_type_script_setup_true_lang-CofY2-NC.js";import"./dayjs.min-TeQhONF1.js";import{_ as D}from"./index-B4w1aCCw.js";import"./index-CWarxRuf.js";import"./index-CND5kIK4.js";import"./_baseUniq-kMXtQ-ld.js";import"./_arrayIncludesWith-DbV0gfeD.js";import"./collapseMotion-Dg6yIgr5.js";import"./move-B3QdINpa.js";import"./RightOutlined-BsZy0Phy.js";import"./VerticalRightOutlined-C0b_NAnm.js";import"./cloneDeep-lQkziu_-.js";import"./schema-form.vue_vue_type_script_setup_true_lang-CqVOkWCm.js";import"./isNumber-BQFvOqOr.js";import"./is-BPG7p_4t.js";import"./index-BT78Vb1q.js";import"./useFlexGapSupport-DLL49fC4.js";import"./hasIn-D18GTBYl.js";import"./debounce-TsE9rPWj.js";import"./QuestionCircleOutlined-DwMKnzgY.js";import"./_castArrayLikeObject-DUjGHYOU.js";import"./index-7VmM7i5b.js";import"./DownOutlined-BRycSuUV.js";import"./index-CIQauGJF.js";import"./pick-yPjmipd3.js";import"./FullscreenOutlined-BZ3QrFwa.js";import"./index-CfT4fuvs.js";import"./LeftOutlined-BKTs5glU.js";import"./zh_CN-CAyhejr6.js";import"./index-iNKLbYy_.js";import"./useMergedState-Cz6_zboM.js";import"./index-B7GNZFXE.js";import"./EnterOutlined-BnZ699CI.js";import"./CheckOutlined-D9pyqrzu.js";import"./CopyOutlined-D95pQ5l8.js";import"./index-g76Nm4Kx.js";import"./isMobile-BbN7I0i_.js";import"./useRefs-QkKGnXKa.js";import"./index-DhL-eOiI.js";import"./index-BRG9fhiq.js";const E=[{title:"会话编号",dataIndex:"tokenId",ellipsis:!0,hideInSearch:!0},{title:"用户名",dataIndex:"username",customRender:({record:t})=>s("div",null,[s("span",{class:"pr-4px"},[t.username]),t.isCurrent&&s(v,{color:"processing"},{default:()=>[w("我")]})])},{title:"部门名称",dataIndex:"deptName"},{title:"登录IP",dataIndex:"ip",width:140},{title:"登录地点",dataIndex:"address"},{title:"浏览器",dataIndex:"browser"},{title:"操作系统",dataIndex:"os"},{title:"登录时间",dataIndex:"time",width:180,customRender:({record:t})=>g(t.time)}],Te=b({name:"SystemMonitorOnline",__name:"index",setup(t){let l=[];const r=p(!0),m=p([]),d=p(!1),c=C(),[h,I]=A({size:"small"}),k=[...E,{title:"操作",width:80,dataIndex:"ACTION",actions:({record:e})=>[{label:"下线",auth:"system:online:kick",disabled:e.disable,popConfirm:{title:"确定下线该用户吗?",onConfirm:()=>x(e)}}]}],x=async e=>{await f.systemOnline.onlineKick({tokenId:e.tokenId}),I.reload()},_=(...e)=>{console.log(...e)},y=e=>{const n=Object.keys(e);if(!n.some(i=>!!e[i])){o();return}m.value=l.filter(i=>n.every(a=>!e[a]||i[a].includes(e[a])))},o=async()=>{d.value=!0,l=await f.systemOnline.onlineList().finally(()=>d.value=!1),m.value=l},u=()=>{r.value&&o()};return T(r,e=>{e&&o()}),S(()=>{o(),c.emitter.on("onlineUser",u)}),O(()=>{c.emitter.off("onlineUser",u)}),(e,n)=>{const i=D;return U(),B(R(h),{"row-key":"tokenId","header-title":"在线用户","title-tooltip":"这是真实操作，请不要随意将其他用户踢下线。","data-source":m.value,columns:k,loading:d.value,onChange:_,onSearch:y,onReload:o},{toolbar:N(()=>[s(i,{checked:r.value,"onUpdate:checked":n[0]||(n[0]=a=>r.value=a),"checked-children":"开启实时更新","un-checked-children":"关闭实时更新"},null,8,["checked"])]),_:1},8,["data-source","loading"])}}});export{Te as default};
