import{bD as Z,d as _,bE as V,bF as ee,aC as te,r as j,bG as oe,w as G,n as H,B as z,c as E,E as b,y as R,F as y,Y as se,ak as ne,a5 as W,a1 as le,bq as ie,C as re,bH as ae,aq as ue,bI as de,G as C,H as me,M as fe,J as ce,a3 as J}from"./index-B8Pm80oX.js";import{S as pe}from"./index-CfT4fuvs.js";import{F as ye,a as ge}from"./FullscreenOutlined-BZ3QrFwa.js";import{d as he}from"./debounce-TsE9rPWj.js";var ve="Expected a function";function O(w,$,a){var p=!0,L=!0;if(typeof w!="function")throw new TypeError(ve);return Z(a)&&(p="leading"in a?!!a.leading:p,L="trailing"in a?!!a.trailing:L),he(w,$,{leading:p,maxWait:$,trailing:L})}const $e=_({__name:"index",props:V({...ee(),fullscreen:{type:Boolean,default:!1}},{open:{type:Boolean},openModifiers:{}}),emits:V(["update:open","update:fullscreen","ok","cancel"],["update:open"]),setup(w,{emit:$}){const a=w,p=$,L=re(),M=te(w,"open"),u=j(a.fullscreen),q=j(""),s={top:"n-resize",left:"w-resize",right:"e-resize",bottom:"s-resize",topLeft:"nw-resize",topright:"ne-resize",bottomLeft:"sw-resize",bottomRight:"se-resize",auto:"auto"};let F=!1;const k=oe("modalWrap"),D=()=>{M.value=!1,p("cancel")},N=async()=>{var e;await J();const o=(e=k.value)==null?void 0:e.querySelector(".ant-modal");o&&o.getBoundingClientRect().left<1&&(o.style.left=`${(document.documentElement.clientWidth-o.offsetWidth)/2}px`)},A=async()=>{u.value=!1,N()},K=(o,e)=>{e.style.cursor="move",e.onmousedown=O(t=>{if(u.value)return;document.body.style.userSelect="none";const d=t.clientX-o.getBoundingClientRect().left,m=t.clientY-o.getBoundingClientRect().top,n=l=>{if(u.value)return;let i=l.clientX-d,f=l.clientY-m;const g=document.documentElement.clientWidth-o.offsetWidth,h=document.documentElement.clientHeight-o.offsetHeight;i<=0&&(i=0),f<=0&&(f=0),i>=g&&(i=g),f>=h&&(f=h),o.style.left=`${Math.max(i,0)}px`,o.style.top=`${Math.max(f,0)}px`},r=()=>{document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",r),document.body.style.userSelect="auto"};document.addEventListener("mousemove",n),document.addEventListener("mouseup",r)},20)},Q=async()=>{await J();const o=k.value,e=o.querySelector(".ant-modal-wrap"),t=o.querySelector(".ant-modal");if(e&&t){N();const d=t.querySelector(".ant-modal-header");d&&K(t,d),e.onmousemove=O(m=>{if(u.value)return;const n=m.clientX-t.offsetLeft,r=m.clientY-t.offsetTop,l=m.clientX-t.offsetWidth-t.offsetLeft,i=m.clientY-t.offsetHeight-t.offsetTop,f=n<=0&&n>-8,g=r<5&&r>-8,h=l>=0&&l<8,x=i>-5&&i<8;f&&r>5&&i<-5?e.style.cursor=s.left:g&&n>5&&l<-5?e.style.cursor=s.top:h&&r>5&&i<-5?e.style.cursor=s.right:x&&n>5&&l<-5?e.style.cursor=s.bottom:n>-8&&n<=5&&r<=5&&r>-8?e.style.cursor=s.topLeft:n>-8&&n<=5&&i<=5&&i>-8?e.style.cursor=s.bottomLeft:l<8&&l>=-5&&r<=5&&r>-8?e.style.cursor=s.topright:l<8&&l>=-5&&i<=5&&i>-8?e.style.cursor=s.bottomRight:e.style.cursor=s.auto},20),e.onmousedown=m=>{if(u.value)return;const{top:n,bottom:r,left:l,right:i}=t.getBoundingClientRect(),f=m.clientX-l,g=m.clientY-n,h=t.offsetWidth,x=t.offsetHeight,c=e.style.cursor,I=O(v=>{if(u.value)return;c!==s.auto&&(document.body.style.userSelect="none");const T=`${Math.max(0,v.clientX-f)}px`,S=`${Math.max(0,v.clientY-g)}px`,B=`${Math.min(i,h+l-v.clientX)}px`,P=`${Math.min(window.innerWidth-l,v.clientX-l)}px`,X=`${Math.min(r,x+n-v.clientY)}px`,Y=`${Math.min(window.innerHeight-n,v.clientY-n)}px`;c===s.left?(t.style.left=T,t.style.width=B):c===s.top?(t.style.top=S,t.style.height=X):c===s.right?t.style.width=P:c===s.bottom?t.style.height=Y:c===s.topLeft?(t.style.left=T,t.style.top=S,t.style.height=X,t.style.width=B):c===s.topright?(t.style.top=S,t.style.width=P,t.style.height=X):c===s.bottomLeft?(t.style.left=T,t.style.width=B,t.style.height=Y):c===s.bottomRight&&(t.style.width=P,t.style.height=Y),q.value=t.style.width},20),U=()=>{document.removeEventListener("mousemove",I),document.removeEventListener("mouseup",U),document.body.style.userSelect="auto",e.style.cursor=s.auto};document.addEventListener("mousemove",I),document.addEventListener("mouseup",U)}}F=!0};return G(M,async o=>{(o&&Object.is(F,!1)||a.destroyOnClose)&&Q()}),G(()=>L.fullPath,D),(o,e)=>{const t=ae;return H(),z(ie,{to:o.getContainer||"body"},[E(t,null,{default:b(()=>[R("div",{ref:"modalWrap",class:le(["draggable-modal",{fullscreen:u.value}])},[E(y(ue),se(y(de)(a,["open","onCancel","onOk","onUpdate:open"]),{open:M.value,"onUpdate:open":e[2]||(e[2]=d=>M.value=d),"mask-closable":!1,"get-container":()=>y(k),width:q.value||o.width,onOk:e[3]||(e[3]=d=>p("ok")),onCancel:e[4]||(e[4]=d=>p("cancel"))}),ne({title:b(()=>[W(o.$slots,"title",{},()=>[C(me(o.$attrs.title||"标题"),1)])]),closeIcon:b(()=>[W(o.$slots,"closeIcon",{},()=>[E(y(pe),{class:"ant-modal-operate",onClick:e[1]||(e[1]=fe(()=>{},["stop"]))},{default:b(()=>[u.value?(H(),z(y(ge),{key:1,onClick:A})):(H(),z(y(ye),{key:0,onClick:e[0]||(e[0]=d=>u.value=!0)})),E(y(ce),{onClick:D})]),_:1})])]),default:b(()=>[W(o.$slots,"default",{},()=>[e[5]||(e[5]=C(" ① 窗口可以拖动；")),e[6]||(e[6]=R("br",null,null,-1)),e[7]||(e[7]=C(" ② 窗口可以通过八个方向改变大小；")),e[8]||(e[8]=R("br",null,null,-1)),e[9]||(e[9]=C(" ③ 窗口可以最小化、最大化、还原、关闭；")),e[10]||(e[10]=R("br",null,null,-1)),e[11]||(e[11]=C(" ④ 限制窗口最小宽度/高度。 "))])]),_:2},[o.$slots.footer?{name:"footer",fn:b(()=>[W(o.$slots,"footer")]),key:"0"}:void 0]),1040,["open","get-container","width"])],2)]),_:3})],8,["to"])}}});export{$e as _,O as t};
