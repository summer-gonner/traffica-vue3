import{g,f as v,t as k}from"./columns-BzhOhbXm.js";import{P as T}from"./PlusOutlined-6eP1e5F5.js";import{I as _}from"./index-CfCbjZdA.js";import{d as E}from"./debounce-TsE9rPWj.js";import{T as F}from"./index-Qnpm0yEw.js";import{c as i,G as m,d as q,r as O,b as V,n as j,q as R,E as r,F as p,N as P}from"./index-B8Pm80oX.js";import{u as U}from"./dynamic-table-D22kRkZE.js";import{S as u}from"./ApiSelect.vue_vue_type_script_setup_true_lang-CofY2-NC.js";import"./dayjs.min-TeQhONF1.js";import{w as b}from"./common-I8s7oTzl.js";import{C as N}from"./index-INlSDQaG.js";import{_ as D}from"./index-7FjZkepP.js";import"./isNumber-BQFvOqOr.js";import"./useMergedState-Cz6_zboM.js";import"./LeftOutlined-BKTs5glU.js";import"./RightOutlined-BsZy0Phy.js";import"./index-CWarxRuf.js";import"./index-CND5kIK4.js";import"./_baseUniq-kMXtQ-ld.js";import"./_arrayIncludesWith-DbV0gfeD.js";import"./collapseMotion-Dg6yIgr5.js";import"./move-B3QdINpa.js";import"./VerticalRightOutlined-C0b_NAnm.js";import"./cloneDeep-lQkziu_-.js";import"./schema-form.vue_vue_type_script_setup_true_lang-CqVOkWCm.js";import"./is-BPG7p_4t.js";import"./index-BT78Vb1q.js";import"./useFlexGapSupport-DLL49fC4.js";import"./hasIn-D18GTBYl.js";import"./QuestionCircleOutlined-DwMKnzgY.js";import"./_castArrayLikeObject-DUjGHYOU.js";import"./index-7VmM7i5b.js";import"./DownOutlined-BRycSuUV.js";import"./index-CIQauGJF.js";import"./dateUtil-E1W9AnjJ.js";import"./pick-yPjmipd3.js";import"./FullscreenOutlined-BZ3QrFwa.js";import"./index-CfT4fuvs.js";import"./zh_CN-CAyhejr6.js";import"./index-iNKLbYy_.js";import"./index-B7GNZFXE.js";import"./EnterOutlined-BnZ699CI.js";import"./CheckOutlined-D9pyqrzu.js";import"./CopyOutlined-D95pQ5l8.js";import"./index-g76Nm4Kx.js";import"./isMobile-BbN7I0i_.js";import"./useRefs-QkKGnXKa.js";import"./index-DhL-eOiI.js";import"./index-BRG9fhiq.js";import"./index-B4w1aCCw.js";import"./index-kU5KwxBj.js";const I=[{title:"姓名",dataIndex:"name",sorter:!0,defaultEditable:!0,editable:({index:e})=>e>0,formItemProps:{defaultValue:"李白",rules:[{required:!0,message:"请输入姓名"}]},editFormItemProps:{extendSearchFormProps:!1,rules:[{required:!0,message:"请输入姓名"}]}},{title:"性别",dataIndex:"gender",formItemProps:{component:"Select",componentProps:({formInstance:e,formModel:l})=>({options:[{label:"男",value:1},{label:"女",value:0}],onChange(){console.log("formModel",l),e==null||e.updateSchema({field:"clothes",componentProps:{options:g(l.gender)}}),l.clothes=""}})},editFormItemProps:{extendSearchFormProps:!0,rules:[{required:!0,type:"number",message:"请选择性别"}],componentProps:({formInstance:e,formModel:l,tableRowKey:a})=>({onChange(){e==null||e.updateSchema({field:`${a}.clothes`,componentProps:{options:g(l.gender)}}),l.clothes=""}})},customRender:({record:e})=>["女","男"][e.gender]},{title:"衣服",dataIndex:"clothes",formItemProps:{component:"Select",componentProps:({formModel:e})=>({options:g(e.gender)})}},{title:"图片",dataIndex:"img",hideInSearch:!0,formItemProps:{component:"Upload",defaultValue:[{uid:"-1",name:"image.png",status:"done",url:"https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png"}],componentProps:{maxCount:1,listType:"picture-card",action:"https://www.mocky.io/v2/5cc8019d300000980a055e76"},componentSlots:({formModel:e})=>({default:()=>{var l;return(l=e.img)!=null&&l.length?"":i("div",null,[i(T,null,null),i("div",{class:"mt-8px"},[m("Upload")])])}})},customRender:({record:e})=>i(_,{width:100,src:e.img},null)},{title:"价格",dataIndex:"price",editFormItemProps:{component:"InputNumber",rules:[{required:!0,message:"请输入价格！"}]},customRender:({record:e})=>`${e.price}元`},{title:"状态",dataIndex:"status",formItemProps:{component:"Select",componentProps:({formInstance:e,schema:l})=>({showSearch:!0,filterOption:!1,request:()=>v(),onSearch:E(async a=>{l.value.loading=!0;const n={field:l.value.field,componentProps:{options:[]}};e==null||e.updateSchema([n]);const d=await v(a).finally(()=>l.value.loading=!1);console.log("onSearch keyword",a,e,n),n.componentProps.options=d,e==null||e.updateSchema([n])},500),onChange(a){console.log("onChange",a),e.setFieldsValue({status:a})}})},editFormItemProps:{rules:[{required:!0,type:"number",message:"请选择状态"}]},customRender:({record:e})=>i(F,{color:e.status==1?"red":"default"},{default:()=>[["已售罄","热卖中"][e.status]]})}],Ne=q({name:"EditRowTable",__name:"index",setup(e){const[l]=U(),a=O("cell"),n=async t=>(console.log("params",t),await b(500),{...t,items:k}),d=V(()=>[...I,{title:"操作",hideInTable:a.value==="cell",width:200,dataIndex:"ACTION",actions:({record:t},o)=>{const{startEditable:s,cancelEditable:f,isEditable:w,getEditFormModel:x,validateRow:C}=o;return w(t.id)?[{label:"保存",onClick:async()=>{var h;const c=await C(t.id);P.loading({content:"保存中...",key:t.id}),console.log("result",c),console.log("保存",x(t.id)),await b(2e3),f(t.id),P.success({content:"保存成功!",key:t.id,duration:2}),Object.assign(t,{...c,img:((h=c.img[0])==null?void 0:h.thumbUrl)||t.img})}},{label:"取消",onClick:()=>{f(t.id)}}]:[{label:"编辑",onClick:()=>{s(t.id,t)}}]}}]),S=(t,o,s)=>{console.log("handleCancelSave",t,o,s)},y=async(t,o,s)=>{console.log("handleSave",t,o,s),await b(2e3),Object.assign(s,o),console.log("originRow",s)};return(t,o)=>(j(),R("div",null,[i(p(D),{message:"可编辑行表格",type:"info","show-icon":""},{description:r(()=>o[1]||(o[1]=[m(" 可编辑行表格-可编辑行表格使用示例 ")])),_:1}),i(p(N),{title:"可编辑行表格基本使用示例",style:{"margin-top":"20px"}},{default:r(()=>[i(p(l),{size:"small",bordered:"","data-request":n,columns:d.value,"editable-type":a.value,"on-save":y,"on-cancel":S,"row-key":"id"},{toolbar:r(()=>[i(p(u),{ref:"select",value:a.value,"onUpdate:value":o[0]||(o[0]=s=>a.value=s)},{default:r(()=>[i(p(u).Option,{value:"single"},{default:r(()=>o[2]||(o[2]=[m("单行编辑")])),_:1}),i(p(u).Option,{value:"multiple"},{default:r(()=>o[3]||(o[3]=[m("多行编辑")])),_:1}),i(p(u).Option,{value:"cell"},{default:r(()=>o[4]||(o[4]=[m("可编辑单元格")])),_:1})]),_:1},8,["value"])]),_:1},8,["columns","editable-type"])]),_:1})]))}});export{Ne as default};
