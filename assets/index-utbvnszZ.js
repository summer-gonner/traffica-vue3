import{d as S,r as b,n as k,q as I,y as m,a5 as E,G as u,b as K,B as U,E as a,c as l,ak as q,F as _,H as A,aY as g,aq as B,cI as V,A as L,X as M}from"./index-B8Pm80oX.js";import{_ as O,b as F}from"./AvatarUpload.vue_vue_type_script_setup_true_lang-Yz2IqLR8.js";import N from"./DeptTree-CZa4yk3B.js";import{t as X}from"./index.vue_vue_type_style_index_0_lang-CFuk3e67.js";import{u as R}from"./dynamic-table-D22kRkZE.js";import"./ApiSelect.vue_vue_type_script_setup_true_lang-CofY2-NC.js";import"./dayjs.min-TeQhONF1.js";import{u as T}from"./useFormModal-CmrBxBAu.js";import{f as G}from"./common-I8s7oTzl.js";import{_ as W}from"./index-7FjZkepP.js";import"./dateUtil-E1W9AnjJ.js";import"./index-Qnpm0yEw.js";import"./PlusOutlined-6eP1e5F5.js";import"./index-DhL-eOiI.js";import"./index-BT78Vb1q.js";import"./cloneDeep-lQkziu_-.js";import"./useFlexGapSupport-DLL49fC4.js";import"./hasIn-D18GTBYl.js";import"./_arrayIncludesWith-DbV0gfeD.js";import"./debounce-TsE9rPWj.js";import"./QuestionCircleOutlined-DwMKnzgY.js";import"./collapseMotion-Dg6yIgr5.js";import"./_castArrayLikeObject-DUjGHYOU.js";import"./index-BRG9fhiq.js";import"./CheckOutlined-D9pyqrzu.js";import"./useRefs-QkKGnXKa.js";import"./useMergedState-Cz6_zboM.js";import"./index-CND5kIK4.js";import"./_baseUniq-kMXtQ-ld.js";import"./index-CWarxRuf.js";import"./move-B3QdINpa.js";import"./RightOutlined-BsZy0Phy.js";import"./index-iNKLbYy_.js";import"./index-CfT4fuvs.js";import"./FullscreenOutlined-BZ3QrFwa.js";import"./VerticalRightOutlined-C0b_NAnm.js";import"./schema-form.vue_vue_type_script_setup_true_lang-CqVOkWCm.js";import"./isNumber-BQFvOqOr.js";import"./is-BPG7p_4t.js";import"./index-7VmM7i5b.js";import"./DownOutlined-BRycSuUV.js";import"./index-CIQauGJF.js";import"./pick-yPjmipd3.js";import"./LeftOutlined-BKTs5glU.js";import"./zh_CN-CAyhejr6.js";import"./index-B7GNZFXE.js";import"./EnterOutlined-BnZ699CI.js";import"./CopyOutlined-D95pQ5l8.js";import"./index-g76Nm4Kx.js";import"./isMobile-BbN7I0i_.js";import"./index-B4w1aCCw.js";import"./useModal-ClPC9oek.js";const j=[{field:"avatar",component:()=>O,label:"头像"},{field:"username",component:"Input",label:"用户名",rules:[{required:!0}]},{field:"password",label:"密码",component:"InputPassword",componentProps:{placeholder:"无需修改请留空"}},{field:"nickname",component:"Input",label:"呢称",colProps:{span:12}},{field:"email",component:"Input",label:"邮箱",colProps:{span:12}},{field:"mobile",component:"Input",label:"手机",colProps:{span:12}},{field:"remark",component:"InputTextArea",label:"备注"},{field:"status",component:"RadioGroup",label:"状态",defaultValue:1,componentProps:{options:[{label:"启用",value:1},{label:"禁用",value:0}]}}],H={class:"split-wrapper"},Y={class:"left-content"},z={class:"right-content"},J=S({__name:"index",setup(P){const p=b();let o,v;const c=X(function(n){p.value&&(p.value.style.width=`${v+n.clientX-o}px`)},20),d=()=>{document.documentElement.style.userSelect="unset",document.documentElement.removeEventListener("mousemove",c),document.documentElement.removeEventListener("mouseup",d)},i=n=>{o=n.clientX,p.value&&(v=parseInt(window.getComputedStyle(p.value).width,10)),document.documentElement.style.userSelect="none",document.documentElement.addEventListener("mousemove",c),document.documentElement.addEventListener("mouseup",d)};return(n,r)=>(k(),I("div",H,[m("div",{ref_key:"scalable",ref:p,class:"scalable"},[m("div",Y,[E(n.$slots,"left-content",{},()=>[r[0]||(r[0]=u(" 右边内容区 "))])]),m("div",{ref:"separator",class:"separator",onMousedown:i},r[1]||(r[1]=[m("i",null,null,-1),m("i",null,null,-1)]),544)],512),m("div",z,[E(n.$slots,"right-content",{},()=>[r[2]||(r[2]=u(" 右边内容区 "))])])]))}}),ze=S({name:"SystemUser",__name:"index",setup(P){const[p,o]=R({formProps:{autoSubmitOnEnter:!0}}),[v]=T(),c=b(),d=b([]),i=b({selectedRowKeys:[],onChange:(e,t)=>{console.log(`selectedRowKeys: ${e}`,"selectedRows: ",t),i.value.selectedRowKeys=e}}),n=K(()=>i.value.selectedRowKeys.length),r=async e=>{const t=await g.systemUser.userList({...e,deptId:c.value});return i.value.selectedRowKeys=[],t},h=async(e={})=>{const{userCreate:t,userUpdate:f}=g.systemUser,w=!!e.id,[s]=await v({modalProps:{title:`${w?"编辑":"新增"}用户`,width:700,onFinish:async y=>{console.log("新增/编辑用户",y),y.id=e.id,e.id?await f({id:e.id},y):await t(y),o==null||o.reload()}},formProps:{labelWidth:100,schemas:j,autoSubmitOnEnter:!0}});e.id?s==null||s.updateSchema([{field:"username",componentProps:{disabled:!0}},{field:"password",required:!1}]):s==null||s.updateSchema([{field:"username",componentProps:{disabled:!1}},{field:"password",required:!0,defaultValue:"a123456",componentProps:{placeholder:"请输入"}}]),s==null||s.updateSchema([{field:"deptId",componentProps:{treeDefaultExpandedKeys:G(d.value,s==null?void 0:s.getFieldsValue().deptId)||[],treeData:d.value}}])},C=async e=>{const{userDelete:t}=g.systemUser;Array.isArray(e)?B.confirm({title:"确定要删除所选的用户吗?",icon:l(V,null,null),centered:!0,onOk:async()=>{await t({id:e.join(",")}),o==null||o.reload()}}):await t({id:e}).finally(o==null?void 0:o.reload)},$=e=>{c.value=e,o==null||o.reload()},D=e=>{d.value=e},x=[...F,{title:"操作",width:80,dataIndex:"ACTION",fixed:"right",actions:({record:e})=>[{icon:"ant-design:edit-outlined",tooltip:"编辑用户资料",auth:{perm:"system:user:update",effect:"disable"},onClick:()=>h(e)},{icon:"ant-design:delete-outlined",color:"red",tooltip:"删除此账号",auth:"system:user:delete",popConfirm:{title:"你确定要删除吗？",placement:"left",onConfirm:()=>C(e.id)}}]}];return(e,t)=>{const f=L("a-button"),w=M;return k(),U(_(J),null,{"left-content":a(()=>[l(N,{onSelect:$,onInit:D})]),"right-content":a(()=>[l(_(p),{"header-title":"用户管理","show-index":"","title-tooltip":"请不要随意删除用户，避免到影响其他用户的使用。","data-request":r,columns:x,scroll:{x:2e3},"row-selection":i.value},q({toolbar:a(()=>[l(f,{type:"primary",disabled:!e.$auth("system:user:create"),onClick:t[1]||(t[1]=s=>h({}))},{default:a(()=>[l(w,{icon:"ant-design:plus-outlined"}),t[4]||(t[4]=u(" 新增 "))]),_:1},8,["disabled"]),l(f,{type:"error",disabled:!n.value||!e.$auth("system:user:delete"),onClick:t[2]||(t[2]=s=>C(i.value.selectedRowKeys))},{default:a(()=>[l(w,{icon:"ant-design:delete-outlined"}),t[5]||(t[5]=u(" 删除 "))]),_:1},8,["disabled"])]),_:2},[n.value?{name:"title",fn:a(()=>[l(_(W),{class:"w-full",type:"info","show-icon":""},{message:a(()=>[u(" 已选 "+A(n.value)+" 项 ",1),l(f,{type:"link",onClick:t[0]||(t[0]=s=>i.value.selectedRowKeys=[])},{default:a(()=>t[3]||(t[3]=[u("取消选择")])),_:1})]),_:1})]),key:"0"}:void 0]),1032,["row-selection"])]),_:1})}}});export{ze as default};
