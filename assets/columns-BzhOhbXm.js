import{w as _}from"./common-I8s7oTzl.js";import{aA as M,aW as D,r as c,c as d,aX as m,aT as x}from"./index-B8Pm80oX.js";import{d as y}from"./debounce-TsE9rPWj.js";import{T as j}from"./index-Qnpm0yEw.js";async function V(e){return M({url:"/dict/data",method:"GET",params:e})}const z=D("dict",()=>{const e=c(new Map),t=c(new Map),a=c(new Map),r=n=>{const u=(Array.isArray(n)?n:[n]).map(async o=>{if(e.value.has(o)&&!a.value.has(o))return e.value.get(o);e.value.set(o,[]),a.value.set(o,!0);const i=await V({type:o}).finally(()=>a.value.delete(o));return e.value.set(o,i),t.value.set(o,new Map(i.map(p=>[p.value,p.label]))),i});return Promise.all(u)},l=new Proxy({},{get(n,s){if(!s.startsWith("__v_"))return e.value.has(s)||a.value.has(s)||r(s),e.value.get(s)}}),S=(n,s)=>{var u;return l[n],((u=t.value.get(n))==null?void 0:u.get(s))||""},b=new Proxy({},{get(n,s){return a.value.get(s)||!1}});return{dictData:l,dictPending:b,fetchDict:r,showDictLabel:S}});function g(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!x(e)}const C=["王路飞","王大蛇","李白","刺客伍六七"],{fetchDict:w,dictPending:h,showDictLabel:f}=z(),v=async(e="")=>{const[t]=await w("sell_status");return _(100,t.filter(a=>a.label.includes(e)))},P=e=>e===1?[{label:"西装",value:1},{label:"领带",value:0}]:e===0?[{label:"裙子",value:1},{label:"包包",value:0}]:[],T=Array.from({length:30}).map((e,t)=>{const a=~~(Math.random()*2);return{id:t+1,date:new Date().toLocaleString(),name:C[~~(Math.random()*4)],clothes:P(a)[~~(Math.random()*2)].label,price:~~(Math.random()*1e3),gender:a,img:"https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png",status:~~(Math.random()*2),nested:{prop:`嵌套属性 ${t+1}`}}}),N=[{title:"姓名",dataIndex:"name",sorter:!0,width:300,resizable:!0,formItemProps:{defaultValue:"李白",required:!0}},{title:"性别",dataIndex:"gender",width:120,resizable:!0,formItemProps:{component:"Select",componentProps:({formInstance:e,formModel:t})=>({request:async()=>{const[a]=await w("gender");return a},onChange(){e==null||e.updateSchema({field:"clothes",componentProps:{options:P(t.gender)}}),t.clothes=""}})},customRender:({record:e})=>{let t;return d(m,{spinning:h.sell_status,size:"small"},g(t=f("gender",e.gender))?t:{default:()=>[t]})}},{title:"衣服",dataIndex:"clothes",formItemProps:{component:"Select",componentProps:({tableInstance:e})=>({onChange(){e==null||e.reload()}})}},{title:"价格",dataIndex:"price",formItemProps:{component:"InputNumber"},customRender:({record:e})=>`${e.price}元`},{title:"嵌套属性",dataIndex:["nested","prop"]},{title:"状态",dataIndex:"status",formItemProps:{component:"Select",componentProps:({formInstance:e,schema:t})=>({showSearch:!0,filterOption:!1,request:()=>v(),onSearch:y(async a=>{t.value.loading=!0;const r={field:"status",componentProps:{options:[]}};e==null||e.updateSchema([r]),console.log("onSearch keyword",a);const l=await v(a).finally(()=>t.value.loading=!1);r.componentProps.options=l,e==null||e.updateSchema([r])},500),onChange(a){console.log("onChange",a)}})},customRender:({record:e})=>{let t;return d(m,{spinning:h.sell_status,size:"small"},{default:()=>[d(j,{color:e.status==1?"red":"default"},g(t=f("sell_status",e.status))?t:{default:()=>[t]})]})}}];export{N as c,v as f,P as g,T as t};
