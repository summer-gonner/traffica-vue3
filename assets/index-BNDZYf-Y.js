import{f as h}from"./dateUtil-E1W9AnjJ.js";import{aY as a,d as b,n as C,q as w,c as s,E as p,y as x,F as n,G as l,A as D}from"./index-B8Pm80oX.js";import{f as I}from"./common-I8s7oTzl.js";import{u as k}from"./dynamic-table-D22kRkZE.js";import"./ApiSelect.vue_vue_type_script_setup_true_lang-CofY2-NC.js";import"./dayjs.min-TeQhONF1.js";import"./index.vue_vue_type_style_index_0_lang-CFuk3e67.js";import{u as T}from"./useFormModal-CmrBxBAu.js";import"./index-CWarxRuf.js";import"./index-CND5kIK4.js";import"./_baseUniq-kMXtQ-ld.js";import"./_arrayIncludesWith-DbV0gfeD.js";import"./collapseMotion-Dg6yIgr5.js";import"./move-B3QdINpa.js";import"./RightOutlined-BsZy0Phy.js";import"./VerticalRightOutlined-C0b_NAnm.js";import"./cloneDeep-lQkziu_-.js";import"./schema-form.vue_vue_type_script_setup_true_lang-CqVOkWCm.js";import"./isNumber-BQFvOqOr.js";import"./is-BPG7p_4t.js";import"./index-BT78Vb1q.js";import"./useFlexGapSupport-DLL49fC4.js";import"./hasIn-D18GTBYl.js";import"./debounce-TsE9rPWj.js";import"./QuestionCircleOutlined-DwMKnzgY.js";import"./_castArrayLikeObject-DUjGHYOU.js";import"./index-7VmM7i5b.js";import"./DownOutlined-BRycSuUV.js";import"./index-CIQauGJF.js";import"./pick-yPjmipd3.js";import"./FullscreenOutlined-BZ3QrFwa.js";import"./index-CfT4fuvs.js";import"./LeftOutlined-BKTs5glU.js";import"./zh_CN-CAyhejr6.js";import"./index-iNKLbYy_.js";import"./useMergedState-Cz6_zboM.js";import"./index-B7GNZFXE.js";import"./EnterOutlined-BnZ699CI.js";import"./CheckOutlined-D9pyqrzu.js";import"./CopyOutlined-D95pQ5l8.js";import"./index-g76Nm4Kx.js";import"./isMobile-BbN7I0i_.js";import"./useRefs-QkKGnXKa.js";import"./index-Qnpm0yEw.js";import"./index-DhL-eOiI.js";import"./index-BRG9fhiq.js";import"./index-B4w1aCCw.js";import"./useModal-ClPC9oek.js";const N=[{title:"部门名称",dataIndex:"deptName",align:"left"},{title:"排序",dataIndex:"deptSort",width:50,hideInSearch:!0},{title:"创建时间",dataIndex:"createTime",width:200,hideInSearch:!0,customRender({text:r}){return r.createTime===""?"":h(r.createTime)}}],_=[{field:"name",component:"Input",label:"部门名称",rules:[{required:!0,type:"string"}]},{field:"parentId",component:"TreeSelect",label:"上级部门",componentProps:{fieldNames:{label:"name",value:"id"},getPopupContainer:()=>document.body,request:async({schema:r,formModel:d})=>{const o=await a.systemDept.deptList({});return r.value.componentProps.treeDefaultExpandedKeys=I(o,d.parentId),o}}},{field:"orderNo",label:"排序",component:"InputNumber",required:!0,componentProps:{style:{width:"100%"}}}],P={class:"flex gap-2 ml-2"},It=b({name:"SystemDept",__name:"index",setup(r){const[d,o]=k(),[c]=T(),u=async t=>{var i;const[e]=await c({modalProps:{title:`${t.id?"编辑":"新增"}部门`,width:"50%",onFinish:async m=>{console.log("新增/编辑部门",m),t.id?await a.systemDept.deptUpdate({id:t.id},m):await a.systemDept.deptCreate(m),o==null||o.reload()}},formProps:{labelWidth:100,schemas:_}});e==null||e.setFieldsValue({...t,parentId:(i=t.parent)==null?void 0:i.id})},f=async t=>{await a.systemDept.deptDelete({id:t.id}),o==null||o.reload()},y=[...N,{title:"操作",width:130,dataIndex:"ACTION",hideInSearch:!0,fixed:"right",actions:({record:t})=>[{label:"编辑",auth:{perm:"system:dept:update",effect:"disable"},onClick:()=>u(t)},{label:"删除",auth:"system:dept:delete",popConfirm:{title:"你确定要删除吗？",placement:"left",onConfirm:()=>f(t)}}]}];return(t,e)=>{const i=D("a-button");return C(),w("div",null,[s(n(d),{"row-key":"id","header-title":"部门管理","data-request":n(a).systemDept.deptList,columns:y,bordered:"",size:"small"},{afterHeaderTitle:p(()=>[x("div",P,[s(i,{onClick:n(o).expandAll},{default:p(()=>e[1]||(e[1]=[l("展开全部")])),_:1},8,["onClick"]),s(i,{onClick:n(o).collapseAll},{default:p(()=>e[2]||(e[2]=[l("折叠全部")])),_:1},8,["onClick"])])]),toolbar:p(()=>[s(i,{type:"primary",disabled:!t.$auth("system:dept:create"),onClick:e[0]||(e[0]=m=>u({}))},{default:p(()=>e[3]||(e[3]=[l(" 新增 ")])),_:1},8,["disabled"])]),_:1},8,["data-request"])])}}});export{It as default};
