import{_ as W}from"./file-upload-drawer.vue_vue_type_script_setup_true_lang-BCFS9Tz_.js";import{cw as Y,c as l,I as h,d as J,r as m,b as y,w as F,n as V,q as Q,E as o,B as X,F as u,G as f,L as Z,H as K,K as ee,aq as te,cI as ae,aY as O,N as H,A as re,dr as ne,J as le,a8 as ie,a6 as se}from"./index-B8Pm80oX.js";import"./index.vue_vue_type_style_index_0_lang-CFuk3e67.js";import{u as oe}from"./useFormModal-CmrBxBAu.js";import{D as ue}from"./index-CWarxRuf.js";import{M as v}from"./index-CND5kIK4.js";import{C as ce}from"./CopyOutlined-D95pQ5l8.js";import{D as de}from"./index-DhL-eOiI.js";import{S as fe}from"./index-CfT4fuvs.js";var pe=4;function _(a){return Y(a,pe)}var me={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.3 459a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V856c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V613.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 459z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-upload",theme:"outlined"};function z(a){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},r=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(e).filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable}))),r.forEach(function(i){ve(a,i,e[i])})}return a}function ve(a,t,e){return t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}var P=function(t,e){var r=z({},t,e.attrs);return l(h,z({},r,{icon:me}),null)};P.displayName="CloudUploadOutlined";P.inheritAttrs=!1;var he={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M632 698.3l141.9-112a8 8 0 000-12.6L632 461.7c-5.3-4.2-13-.4-13 6.3v76H295c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h324v76c0 6.7 7.8 10.4 13 6.3zm261.3-405L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v278c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V422c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-83.5c0-17-6.7-33.2-18.7-45.2zM640 288H384V184h256v104zm264 436h-56c-4.4 0-8 3.6-8 8v108H184V732c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v148c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V732c0-4.4-3.6-8-8-8z"}}]},name:"delivered-procedure",theme:"outlined"};function L(a){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},r=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(e).filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable}))),r.forEach(function(i){ge(a,i,e[i])})}return a}function ge(a,t,e){return t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}var S=function(t,e){var r=L({},t,e.attrs);return l(h,L({},r,{icon:he}),null)};S.displayName="DeliveredProcedureOutlined";S.inheritAttrs=!1;var be={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M484 443.1V528h-84.5c-4.1 0-7.5 3.1-7.5 7v42c0 3.8 3.4 7 7.5 7H484v84.9c0 3.9 3.2 7.1 7 7.1h42c3.9 0 7-3.2 7-7.1V584h84.5c4.1 0 7.5-3.2 7.5-7v-42c0-3.9-3.4-7-7.5-7H540v-84.9c0-3.9-3.1-7.1-7-7.1h-42c-3.8 0-7 3.2-7 7.1zm396-144.7H521L403.7 186.2a8.15 8.15 0 00-5.5-2.2H144c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V330.4c0-17.7-14.3-32-32-32zM840 768H184V256h188.5l119.6 114.4H840V768z"}}]},name:"folder-add",theme:"outlined"};function A(a){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},r=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(e).filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable}))),r.forEach(function(i){Oe(a,i,e[i])})}return a}function Oe(a,t,e){return t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}var M=function(t,e){var r=A({},t,e.attrs);return l(h,A({},r,{icon:be}),null)};M.displayName="FolderAddOutlined";M.inheritAttrs=!1;var ye={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"}}]},name:"menu",theme:"outlined"};function N(a){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},r=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(e).filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable}))),r.forEach(function(i){Pe(a,i,e[i])})}return a}function Pe(a,t,e){return t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}var w=function(t,e){var r=N({},t,e.attrs);return l(h,N({},r,{icon:ye}),null)};w.displayName="MenuOutlined";w.inheritAttrs=!1;var Se={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M567.1 512l318.5-319.3c5-5 1.5-13.7-5.6-13.7h-90.5c-2.1 0-4.2.8-5.6 2.3l-273.3 274-90.2-90.5c12.5-22.1 19.7-47.6 19.7-74.8 0-83.9-68.1-152-152-152s-152 68.1-152 152 68.1 152 152 152c27.7 0 53.6-7.4 75.9-20.3l90 90.3-90.1 90.3A151.04 151.04 0 00288 582c-83.9 0-152 68.1-152 152s68.1 152 152 152 152-68.1 152-152c0-27.2-7.2-52.7-19.7-74.8l90.2-90.5 273.3 274c1.5 1.5 3.5 2.3 5.6 2.3H880c7.1 0 10.7-8.6 5.6-13.7L567.1 512zM288 370c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80zm0 444c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"}}]},name:"scissor",theme:"outlined"};function B(a){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},r=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(e).filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable}))),r.forEach(function(i){Me(a,i,e[i])})}return a}function Me(a,t,e){return t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}var C=function(t,e){var r=B({},t,e.attrs);return l(h,B({},r,{icon:Se}),null)};C.displayName="ScissorOutlined";C.inheritAttrs=!1;const Ae=a=>[{field:"toName",component:"Input",label:`${a.type==="dir"?"文件夹":"文件"}名称`,defaultValue:a.name,rules:[{required:!0,type:"string",validator:(t,e)=>e&&e===a.name?Promise.reject("修改前后名称一致"):e&&!e.includes("/")?Promise.resolve():Promise.reject(`请输入合法${a.type==="dir"?"文件夹":"文件"}的名称`)}],componentProps:{placeholder:"输入重命名后的名称"}}],we=[{field:"dirName",component:"Input",label:"文件夹名称",rules:[{required:!0,type:"string",validator:(a,t)=>t&&!t.includes("/")?Promise.resolve():Promise.reject("请输入合法的文件夹路径")}],componentProps:{placeholder:"请输入文件夹名称"}}],Ce=[{field:"key",component:"Input",label:"关键字",defaultValue:"",rules:[{required:!0,type:"string",validator:(a,t)=>t&&!t.includes("/")?Promise.resolve():Promise.reject("请输入合法的名称")}],componentProps:{placeholder:"请输入搜索关键字"}}],Ne=J({name:"FileOperateButtonList",__name:"file-operate-button-list",props:{selectedFileList:{type:Array,required:!0},parsePath:{type:Function,required:!0},searchKey:{type:String,required:!0},updateOperateStatus:{type:Function,required:!0}},emits:["changed","update:searchKey"],setup(a,{emit:t}){const e=a,r=t,[i]=oe(),D=m(),c=m(!1),d=m(!1),g=m(""),b=m([]),E=y(()=>b.value.length>0?!1:e.selectedFileList.length<=0),I=y(()=>c.value&&g.value===e.parsePath()),k=y(()=>!ne(e.searchKey));F(c,n=>{n&&(d.value&&(d.value=!1),j())}),F(d,n=>{n&&(c.value&&(c.value=!1),j())});const q=({key:n})=>{console.log("command",n),n==="copy"?d.value=!0:n==="cut"?c.value=!0:n==="delete"?te.confirm({title:"你确定要删除吗?",icon:l(ae),onOk:x}):n==="cancel"&&(c.value=!1,d.value=!1,$())},j=()=>{b.value=_(e.selectedFileList),g.value=e.parsePath()},$=()=>{g.value="",b.value=[]},U=async()=>{try{e.updateOperateStatus(!0);const n={files:b.value,originPath:g.value,toPath:e.parsePath()};let s;if(c.value&&!d.value)await O.netDiskManage.netDiskManageCut(n),s="剪切",c.value=!1;else if(!c.value&&d.value)await O.netDiskManage.netDiskManageCopy(n),s="复制",d.value=!1;else throw new Error("unsupport operate");$(),H.success(`${s}成功`),r("changed")}finally{e.updateOperateStatus(!1)}},x=async()=>{const n=e.parsePath(),s=_(e.selectedFileList);await O.netDiskManage.netDiskManageDelete({path:n,files:s},{showSuccessMsg:!1}),H.success("已删除指定列表"),r("changed")},R=async()=>{if(k.value){r("update:searchKey","");return}await i({modalProps:{title:"全盘搜索",width:700,onFinish:async n=>{r("update:searchKey",n.key)}},formProps:{labelWidth:100,schemas:Ce}})},G=()=>{var n;(n=D.value)==null||n.open(e.parsePath())},T=async()=>{await i({modalProps:{title:"创建文件夹",width:700,onFinish:async n=>{await O.netDiskManage.netDiskManageMkdir({path:e.parsePath(),dirName:n.dirName}),r("changed")}},formProps:{labelWidth:100,schemas:we}})};return(n,s)=>{const p=re("a-button");return V(),Q(ee,null,[l(u(fe),null,{default:o(()=>[d.value||c.value?(V(),X(p,{key:0,disabled:I.value,onClick:U},{default:o(()=>[l(u(S)),s[1]||(s[1]=f("粘贴 "))]),_:1},8,["disabled"])):Z("",!0),l(u(ue),{size:"small"},{overlay:o(()=>[l(u(v),{onClick:q},{default:o(()=>[l(u(v).Item,{key:"copy",disabled:!n.$auth("netdisk:manage:copy")},{default:o(()=>[l(u(ce)),s[3]||(s[3]=f(" 复制所选 "))]),_:1},8,["disabled"]),l(u(v).Item,{key:"cut",disabled:!n.$auth("netdisk:manage:cut")},{default:o(()=>[l(u(C),{rotate:-90}),s[4]||(s[4]=f(" 剪切所选 "))]),_:1},8,["disabled"]),l(u(v).Item,{key:"delete",disabled:!n.$auth("netdisk:manage:delete")},{default:o(()=>[l(u(de)),s[5]||(s[5]=f(" 删除所选 "))]),_:1},8,["disabled"]),l(u(v).Item,{key:"cancel",divider:"",disabled:!d.value&&!c.value},{default:o(()=>[l(u(le)),s[6]||(s[6]=f(" 取消粘贴 "))]),_:1},8,["disabled"])]),_:1})]),default:o(()=>[l(u(ie),{title:"注意：复制或剪切时会覆盖重名文件",placement:"top"},{default:o(()=>[l(p,{color:"#e6a23c",disabled:E.value},{icon:o(()=>[l(u(w))]),default:o(()=>[s[2]||(s[2]=f(" 批量操作 "))]),_:1},8,["disabled"])]),_:1})]),_:1}),l(p,{type:"success",disabled:!n.$auth("netdisk:manage:list"),onClick:R},{icon:o(()=>[l(u(se))]),default:o(()=>[f(" "+K(k.value?"取消搜索":"全盘搜索"),1)]),_:1},8,["disabled"]),l(p,{type:"primary",disabled:!n.$auth("netdisk:manage:token"),onClick:G},{icon:o(()=>[l(u(P))]),default:o(()=>[s[7]||(s[7]=f(" 上传文件 "))]),_:1},8,["disabled"]),l(p,{onClick:T},{icon:o(()=>[l(u(M))]),default:o(()=>[s[8]||(s[8]=f(" 创建文件夹 "))]),_:1})]),_:1}),l(W,{ref_key:"uploadDrawerRef",ref:D,onChanged:s[0]||(s[0]=De=>n.$emit("changed"))},null,512)],64)}}});export{Ne as _,Ae as g};
